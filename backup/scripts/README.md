# üóÑÔ∏è Firestore Backup & Restore System

‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firestore ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö CodeLab School Management System

## üìã ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥

- ‚úÖ Backup ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞ collections ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Subcollections (‡πÄ‡∏ä‡πà‡∏ô rooms ‡πÉ‡∏ô branches, students ‡πÉ‡∏ô parents)
- ‚úÖ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Firestore Types (Timestamp, GeoPoint) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô JSON
- ‚úÖ Restore 3 ‡πÇ‡∏´‡∏°‡∏î: Safe / Overwrite / Clean
- ‚úÖ Dry Run Mode (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á)

## üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á tsx

```bash
npm install -D tsx
```

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç package.json

‡πÄ‡∏û‡∏¥‡πà‡∏° scripts (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ):

```json
{
  "scripts": {
    "backup": "tsx --env-file=.env.local backup/scripts/backup.ts",
    "restore": "tsx --env-file=.env.local backup/scripts/restore.ts"
  }
}
```

## üì¶ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Backup

### Backup ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

```bash
npm run backup
```

‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà: `backup/data/backup-YYYY-MM-DD-HH-MM-SS/`

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**

```
‚úÖ Backup completed successfully!
üìÅ Backup location: ./backup/data/backup-2024-01-15-10-30-00
üíæ Backup name: backup-2024-01-15-10-30-00
```

### Backup ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ collections

```bash
npm run backup -- --collections branches,subjects,teachers
```

## üîÑ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Restore (3 ‡πÇ‡∏´‡∏°‡∏î)

### üõ°Ô∏è ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà 1: Safe Mode (Default - ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)

```bash
npm run restore backup-2024-01-15-10-30-00
```

**‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:**

- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
- ‚è≠Ô∏è ‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö)
- ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏ß‡πâ

**‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:** ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà

---

### ‚ö†Ô∏è ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà 2: Overwrite Mode (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö)

```bash
npm run restore backup-2024-01-15-10-30-00 --overwrite
```

**‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:**

- ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ ID ‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
- ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏ß‡πâ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô backup)

**‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:** ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà

---

### üî¥ ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà 3: Clean Mode (‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏∏‡∏î backup ‡∏à‡∏£‡∏¥‡∏á‡πÜ)

```bash
npm run restore backup-2024-01-15-10-30-00 --clean
```

**‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£:**

- üóëÔ∏è **‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô collection**
- ‚úÖ Restore ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å backup
- ‚ùå **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ**

**‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:** ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏à‡∏∏‡∏î backup ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô (‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà)

‚ö†Ô∏è **‡∏£‡∏∞‡∏ß‡∏±‡∏á:** ‡πÇ‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏±‡∏á backup ‡∏ó‡∏¥‡πâ‡∏á‡∏´‡∏°‡∏î!

---

## üîç Dry Run (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

```bash
# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Safe Mode
npm run restore backup-2024-01-15-10-30-00 --dry-run

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Overwrite Mode
npm run restore backup-2024-01-15-10-30-00 --overwrite --dry-run

# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Clean Mode
npm run restore backup-2024-01-15-10-30-00 --clean --dry-run
```

‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á **‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á**

---

## üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏´‡∏°‡∏î

| ‡πÇ‡∏´‡∏°‡∏î       | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°  | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà | ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö | ‡∏•‡∏ö‡∏Å‡πà‡∏≠‡∏ô restore |
| ---------- | ----------- | ---------- | -------- | -------------- |
| Safe Mode  | ‡∏Ç‡πâ‡∏≤‡∏°        | ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö    | ‚ùå       | ‚ùå             |
| Overwrite  | ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö | ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö    | ‚úÖ       | ‚ùå             |
| Clean Mode | ‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö | ‚ùå ‡∏´‡∏≤‡∏¢     | ‚úÖ       | ‚úÖ             |

---

## üéØ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Use Cases

### Use Case 1: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô

```bash
# 1. Backup ‡∏Å‡πà‡∏≠‡∏ô
npm run backup

# 2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... ‡πÇ‡∏≠‡πä‡∏∞! ‡πÅ‡∏Å‡πâ‡∏ú‡∏¥‡∏î üò±

# 3. Dry run ‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô
npm run restore backup-2024-01-15-10-30-00 --overwrite --dry-run

# 4. Restore ‡∏Å‡∏•‡∏±‡∏ö
npm run restore backup-2024-01-15-10-30-00 --overwrite
```

---

### Use Case 2: ‡∏¢‡πâ‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏à‡∏∏‡∏î backup (‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà)

```bash
# 1. ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• backup ‡πÄ‡∏°‡∏∑‡πà‡∏≠ 3 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô
# 2. ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
# 3. ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ï‡∏≠‡∏ô backup ‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏±‡∏á‡∏õ‡∏Å‡∏ï‡∏¥

# Dry run ‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô
npm run restore backup-2024-01-12-10-00-00 --clean --dry-run

# Restore ‡πÅ‡∏ö‡∏ö Clean (‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏¥‡πâ‡∏á)
npm run restore backup-2024-01-12-10-00-00 --clean
```

---

### Use Case 3: ‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Environment

```bash
# Production
npm run backup

# Development (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå backup ‡∏°‡∏≤)
npm run restore backup-2024-01-15-10-30-00 --clean
```

---

### Use Case 4: Restore ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≤‡∏á collections

```bash
# Restore ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ branches ‡πÅ‡∏•‡∏∞ subjects
npm run restore backup-2024-01-15-10-30-00 --collections branches,subjects --clean
```

---

## üìù ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### Backup Commands

```bash
# Backup ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
npm run backup

# Backup ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ collections
npm run backup -- --collections branches,subjects,teachers

# Backup ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° subcollections
npm run backup -- --no-subcollections
```

### Restore Commands

```bash
# Safe Mode (‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö, ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà)
npm run restore backup-2024-01-15-10-30-00

# Overwrite Mode (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö, ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà)
npm run restore backup-2024-01-15-10-30-00 --overwrite

# Clean Mode (‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á + restore ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏°)
npm run restore backup-2024-01-15-10-30-00 --clean

# Dry Run ‡∏ó‡∏∏‡∏Å‡πÇ‡∏´‡∏°‡∏î
npm run restore backup-2024-01-15-10-30-00 --dry-run
npm run restore backup-2024-01-15-10-30-00 --overwrite --dry-run
npm run restore backup-2024-01-15-10-30-00 --clean --dry-run

# Restore ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ collections
npm run restore backup-2024-01-15-10-30-00 --collections branches,subjects

# Restore ‡∏î‡πâ‡∏ß‡∏¢ batch size ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á
npm run restore backup-2024-01-15-10-30-00 --batch-size 1000
```

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
backup/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ backup-2024-01-15-10-30-00/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _metadata.json          # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ branches.json           # Collection + subcollections
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parents.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ subjects.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ backup-2024-01-16-14-20-00/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ backup.ts
‚îÇ   ‚îî‚îÄ‚îÄ restore.ts
‚îî‚îÄ‚îÄ README.md
```

---

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

1. **Clean Mode**: ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏¥‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÉ‡∏ä‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á!
2. **Subcollections**: ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö parent document, subcollections ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
3. **Timestamp**: ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô ISO string ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Firestore Timestamp
4. **GeoPoint**: ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô `{ latitude, longitude }` ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô GeoPoint
5. **Rate Limits**: Firestore ‡∏°‡∏µ rate limits ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏¢‡∏≠‡∏∞‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô
6. **Countdown**: ‡∏°‡∏µ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏´‡πâ‡∏Å‡∏î Ctrl+C ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô restore ‡∏à‡∏£‡∏¥‡∏á

---

## üîß Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Permission denied

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ environment variables ‡∏Ñ‡∏£‡∏ö
FIREBASE_ADMIN_PROJECT_ID=xxx
FIREBASE_ADMIN_CLIENT_EMAIL=xxx
FIREBASE_ADMIN_PRIVATE_KEY=xxx
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Backup not found

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠ backup ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
ls backup/data/

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ path ‡πÄ‡∏ï‡πá‡∏°
npm run restore ./backup/data/backup-2024-01-15-10-30-00
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Out of memory

```bash
# Backup ‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡∏•‡∏∞ collection
npm run backup -- --collections branches
npm run backup -- --collections parents
npm run backup -- --collections classes
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Rate limit exceeded

```bash
# ‡∏•‡∏î batch size
npm run restore backup-2024-01-15-10-30-00 --batch-size 100
```

---

## üí° Best Practices

1. **Backup ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠**: Backup ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà deploy ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏ç‡πà
2. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Restore**: ‡πÉ‡∏ä‡πâ `--dry-run` ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô restore ‡∏à‡∏£‡∏¥‡∏á
3. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°**:
   - ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≤‡∏¢ ‚Üí Safe Mode
   - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î ‚Üí Overwrite Mode
   - ‡∏¢‡πâ‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí Clean Mode
4. **‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô**: ‡πÄ‡∏Å‡πá‡∏ö backup ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 7 ‡∏ß‡∏±‡∏ô
5. **‡∏•‡∏ö Backup ‡πÄ‡∏Å‡πà‡∏≤**: ‡∏•‡∏ö backup ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 30 ‡∏ß‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞

---

## üìû ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠?

‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏° Dev ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô README ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö!
